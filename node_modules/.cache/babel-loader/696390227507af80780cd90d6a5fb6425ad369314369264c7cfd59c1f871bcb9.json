{"ast":null,"code":"var _jsxFileName = \"/Users/tonny/blockchain/bank/my-app/src/index.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport detectEthereumProvider from \"@metamask/detect-provider\";\nimport { Contract, ethers } from \"ethers\";\nimport { useState, useEffect, useRef } from 'react';\nimport bankManifest from \"./contracts/Bank.json\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const bank = useRef(null);\n  const [bnbBalance, setBNBBalance] = useState(0);\n  const [interestGenerated, setInterestGenerated] = useState(0);\n  const [bmiwBalance, setBMIWBalance] = useState(0);\n  useEffect(() => {\n    initContracts();\n    updateBalances();\n  }, []);\n  let updateBalances = async () => {\n    if (bank.current) {\n      try {\n        const bnbBalance = await bank.current.getBNBBalance();\n        const interestGenerated = await bank.current.getInterestGenerated();\n        const bmiwBalance = await bank.current.getBMIWBalance();\n        setBNBBalance(bnbBalance.toString());\n        setInterestGenerated(interestGenerated.toString());\n        setBMIWBalance(bmiwBalance.toString());\n      } catch (error) {\n        console.error(\"Error updating balances:\", error);\n      }\n    }\n  };\n  let initContracts = async () => {\n    await getBlockchain();\n  };\n  let onSubmitDeposit = async e => {\n    e.preventDefault();\n    const BNBamount = parseFloat(e.target.elements[0].value);\n\n    // Wei to BNB se pasa con ethers.utils recibe un String!!!\n    const tx = await bank.current.deposit({\n      value: ethers.utils.parseEther(String(BNBamount)),\n      gasLimit: 6721975,\n      gasPrice: 20000000000\n    });\n    await tx.wait();\n    updateBalances();\n  };\n  let clickWithdraw = async e => {\n    try {\n      if (isDeposited[msg.sender]) {\n        await await bank.current.withdraw();\n        updateBalances();\n      } else {\n        throw new Error('No previous deposit');\n      }\n    } catch (error) {\n      console.error('Error during withdrawal:', error);\n    }\n  };\n  let getBlockchain = async () => {\n    let provider = await detectEthereumProvider();\n    if (provider) {\n      await provider.request({\n        method: 'eth_requestAccounts'\n      });\n      const networkId = await provider.request({\n        method: 'net_version'\n      });\n      provider = new ethers.providers.Web3Provider(provider);\n      const signer = provider.getSigner();\n      bank.current = new Contract(bankManifest.networks[networkId].address, bankManifest.abi, signer);\n    }\n    return null;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Bank\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"BNB Balance: \", bnbBalance, \" BNB\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Interest Generated: \", interestGenerated, \" BNB\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"BMIW Balance: \", bmiwBalance, \" BMIW\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: e => onSubmitDeposit(e),\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        step: \"0.01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Deposit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => clickWithdraw(),\n      children: \" Withdraw \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 7\n  }, this);\n}\n_s(App, \"4B5OpVimwVTyUx9nBso0xc5Rnl0=\");\n_c = App;\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render( /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 107,\n  columnNumber: 3\n}, this));\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","ReactDOM","detectEthereumProvider","Contract","ethers","useState","useEffect","useRef","bankManifest","jsxDEV","_jsxDEV","App","_s","bank","bnbBalance","setBNBBalance","interestGenerated","setInterestGenerated","bmiwBalance","setBMIWBalance","initContracts","updateBalances","current","getBNBBalance","getInterestGenerated","getBMIWBalance","toString","error","console","getBlockchain","onSubmitDeposit","e","preventDefault","BNBamount","parseFloat","target","elements","value","tx","deposit","utils","parseEther","String","gasLimit","gasPrice","wait","clickWithdraw","isDeposited","msg","sender","withdraw","Error","provider","request","method","networkId","providers","Web3Provider","signer","getSigner","networks","address","abi","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","step","onClick","_c","root","createRoot","document","getElementById","render","$RefreshReg$"],"sources":["/Users/tonny/blockchain/bank/my-app/src/index.js"],"sourcesContent":["\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport detectEthereumProvider from \"@metamask/detect-provider\";\nimport {Contract, ethers} from \"ethers\";\nimport { useState, useEffect, useRef } from 'react';\nimport bankManifest from \"./contracts/Bank.json\";\n\nfunction App(){\n  const bank = useRef(null);\n  const [bnbBalance, setBNBBalance] = useState(0);\n  const [interestGenerated, setInterestGenerated] = useState(0);\n  const [bmiwBalance, setBMIWBalance] = useState(0);\n  \n  useEffect( () => {\n      initContracts();\n      updateBalances();\n  }, [])\n  let updateBalances = async () => {\n    if (bank.current) {\n      try {\n      const bnbBalance = await bank.current.getBNBBalance();\n      const interestGenerated = await bank.current.getInterestGenerated();\n      const bmiwBalance = await bank.current.getBMIWBalance();\n  \n      setBNBBalance(bnbBalance.toString());\n      setInterestGenerated(interestGenerated.toString());\n      setBMIWBalance(bmiwBalance.toString());\n    } catch (error) {\n      console.error(\"Error updating balances:\", error);\n    }\n    }\n  };\n  let initContracts = async () => {\n      await getBlockchain();\n  }\n  \nlet onSubmitDeposit = async (e) => {\n  e.preventDefault();\n\n  const BNBamount = parseFloat(e.target.elements[0].value);\n\n  // Wei to BNB se pasa con ethers.utils recibe un String!!!\n  const tx = await bank.current.deposit({\n      value: ethers.utils.parseEther(String(BNBamount)),\n      gasLimit: 6721975,\n      gasPrice: 20000000000,\n  });\n\n  await tx.wait();\n  updateBalances();\n}\nlet clickWithdraw = async (e) => {\n  try {\n    if (isDeposited[msg.sender]) {\n  await await bank.current.withdraw();\n  updateBalances();\n} else {\n  throw new Error('No previous deposit');\n}\n} catch (error) {\nconsole.error('Error during withdrawal:', error);\n}\n}\n\n\n\n  let getBlockchain = async () => {\n      let provider = await detectEthereumProvider();\n      if(provider) {\n          await provider.request({ method: 'eth_requestAccounts' });\n          const networkId = await provider.request({ method: 'net_version' })\n\n          provider = new ethers.providers.Web3Provider(provider);\n          const signer = provider.getSigner();\n\n          bank.current = new Contract(\n              bankManifest.networks[networkId].address,\n              bankManifest.abi,\n              signer\n          );\n\n      }\n      return null;\n  }\n\n\n  return (\n      <div>\n          <h1>Bank</h1>\n          <p>BNB Balance: {bnbBalance} BNB</p>\n          <p>Interest Generated: {interestGenerated} BNB</p>\n        <p>BMIW Balance: {bmiwBalance} BMIW</p>\n          <form onSubmit= { (e) => onSubmitDeposit(e) } >\n                <input type=\"number\" step=\"0.01\" />\n                <button type=\"submit\">Deposit</button>\n            </form>\n            <button onClick= { () => clickWithdraw() } > Withdraw </button>\n\n      </div>\n  )\n}\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <App />\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}